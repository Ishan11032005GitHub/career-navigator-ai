<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Career Navigator AI</title>
<style>
body{font-family:system-ui,Segoe UI,Roboto,Arial;margin:24px;max-width:900px}
.row{display:flex;gap:12px;margin:12px 0}
textarea{width:100%;height:100px}
button{padding:10px 16px;border-radius:10px;border:1px solid #ddd;cursor:pointer}
.card{border:1px solid #eee;border-radius:16px;padding:16px;margin:12px 0;box-shadow:0 1px 6px rgba(0,0,0,.05)}
.small{opacity:.7;font-size:.9em}
</style>
</head>
<body>
<h1>Career Navigator AI</h1>
<p class="small">Career coach + learning buddy (Ollama mode, text-only).</p>

<div class="card">
  <div class="row">
    <textarea id="msg" placeholder="Ask: 'Review my resume for SWE' or 'Teach me SQL basics'..."></textarea>
  </div>
  <div class="row">
    <input id="thread" placeholder="thread id" value="demo-1" />
    <button id="send">Send</button>
  </div>
  <div id="out" class="card"></div>
</div>

<script>
const API = "http://localhost:11434"; // backend

const sendBtn = document.getElementById('send');
const out = document.getElementById('out');

async function chat(message){
  const thread_id = document.getElementById('thread').value || 'default';
  const r = await fetch(`${API}/api/chat`, {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({
      message,
      thread_id,
      resume_text: null,
      job_posts: null
    })
  });
  const data = await r.json();
console.log("Backend response:", data); // <-- debug

const replyText = (data.reply && typeof data.reply === "string")
  ? data.reply.replace(/\n/g, '<br>')
  : "(no reply from backend)";

const el = document.createElement('div');
el.innerHTML = `<div><b>Assistant:</b> ${replyText}</div>`;
out.prepend(el);
}

sendBtn.onclick = ()=>{
  const m = document.getElementById('msg').value.trim();
  if (m) chat(m);
};
</script>
</body>
</html>
